<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<window xmlns="http://schemas.haulmont.com/cuba/window.xsd"
        caption="msg://editorCaption"
        class="com.audimex.dashboard.web.dashboardwidget.DashboardWidgetEdit"
        datasource="dashboardWidgetDs"
        focusComponent="fieldGroup"
        messagesPack="com.audimex.dashboard.web.dashboardwidget">
    <dsContext>
        <datasource id="dashboardWidgetDs"
                    class="com.audimex.dashboard.entity.DashboardWidget"
                    view="dashboardWidget-view">
        </datasource>
        <collectionDatasource id="widgetParameters"
                    class="com.audimex.dashboard.entity.WidgetParameter"
                    view="master-widgetParameter-view">
            <query>
                <![CDATA[select e from amxd$WidgetParameter e
                        where e.dashboardWidget.id = :ds$dashboardWidgetDs.id
                            and e.dashboardWidgetLink is null]]>
            </query>
        </collectionDatasource>
    </dsContext>
    <dialogMode height="600"
                width="400"/>
    <layout expand="windowActions"
            spacing="true">
        <fieldGroup id="fieldGroup"
                    datasource="dashboardWidgetDs">
            <column width="250px">
                <field id="widgetId" property="widgetId"/>
                <field id="caption" property="caption"/>
                <field id="icon" property="icon"/>
                <field id="description" property="description"/>
                <field id="widgetViewType" property="widgetViewType"
                       required="true"/>
                <field id="frameId" custom="true"/>
                <field id="entityType" property="entityType"/>
                <field id="report" property="report"/>
            </column>
        </fieldGroup>
        <table id="parametersTable" width="100%" height="250px">
            <actions>
                <action id="create"/>
                <action id="edit"/>
                <action id="remove"/>
            </actions>
            <columns>
                <column id="name"/>
                <column id="parameterType"/>
                <column id="referenceToEntity.metaClassName"/>
                <column id="referenceToEntity.viewName"/>
            </columns>
            <rows datasource="widgetParameters"/>
            <buttonsPanel>
                <button id="btnCreate" action="parametersTable.create"/>
                <button id="btnEdit" action="parametersTable.edit"/>
                <button id="btnRemove" action="parametersTable.remove"/>
            </buttonsPanel>
        </table>
        <frame id="windowActions"
               screen="extendedEditWindowActions"/>
    </layout>
</window>
